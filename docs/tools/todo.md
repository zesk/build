# Missing functions

[⬅ Return to index](index.md)
[⬅ Return to top](../index.md)

This file is automatically generated, and includes all functions which are not defined anywhere else in the documentation. **Warning**: assume anything here may change in a new version. 


### `addHashicorpAptKey` - Add keys to enable apt to download terraform directly from

Add keys to enable apt to download terraform directly from hashicorp.com

#### Usage

    addHashicorpAptKey
    

#### Exit codes

- `1` - if environment is awry
- `0` - All good to install terraform

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

### `build-docs.sh` - Build documentation for build system.

Build documentation for build system.

Given that bash is not an ideal template language, caching is mandatory.

Uses a cache at `buildCacheDirectory`

#### Arguments

- `--force` - Force generation, ignore cache directives
- `--unlinked` - Show unlinked functions
- `--unlinked-update` - Update unlinked document file
- `--clean` - Erase the cache before starting.
- `--help` - I need somebody

#### Exit codes

- `0` - Success
- `1` - Issue with environment
- `2` - Argument error

#### Arguments

- `cacheDirectory` - Required. Directory. Cache directory.
- `envFile` - Required. File. Environment file used as base environment for all template generation.

#### Exit codes

- `0` - Always succeeds

### `test.sh` - Run Zesk Build tests

Run Zesk Build tests

#### Arguments

- `--one test` - Optional. Add one test to run.
- `--show` - Optional. Flag. List all tests.
- `--help` - Optional. This help.
- `--clean` - Optional. Delete test artifact files before starting.
- `--messy` - Optional. Do not delete test artifact files afterwards.

#### Exit codes

- `0` - Always succeeds

### `deployBuildEnvironment` - Deploy to a host

Deploy to a host

Loads .build.env


Not possible to deploy to different paths on different hosts

#### Exit codes

- `0` - Always succeeds

#### Environment

- DEPLOY_REMOTE_PATH - path on remote host for deployment data
- APPLICATION_REMOTE_PATH - path on remote host for application
- DEPLOY_USER_HOSTS - list of user@host (will be tokenized by spaces regardless of shell quoting)
- APPLICATION_ID - Version to be deployed

### `deployToRemote` - Deploy current application to one or more hosts

Deploy current application to host at applicationPath.

If this fails it will output the installation log.

When this tool succeeds the application:

- `--deploy` - has been deployed in the remote systems successfully but temporary files may still exist
- `--revert` - No changes should have occurred on the remote host (not guaranteed)
- `--cleanup` - has been installed in the remote systems successfully

Operation:

## Deploy `--deploy` Operation

- On each host, `app.tar.gz` is uploaded to the `applicationPath` first
- On each host, via the shell, change to the `applicationPath` directory
- Decompress the application package, and run the `deploy-remote-finish.sh` script

## Cleanup `--cleanup` Operation

- On each host, via the shell, change to the `applicationPath` directory
- Run the `deploy-remote-finish.sh` script which ...
- Deletes the application package if it still exists, and runs the `deploy-cleanup` hook

## Undo `--revert` Operation

- On each host, via the shell, change to the `applicationPath` directory
- Run the `deploy-remote-finish.sh` script which ...
- Deploys the prior version in the same manner, and ... <!-- needs expansion TODO -->
- Runs the `deploy-revert` hook afterwards

The `userAtHost` can be passed as follows:

    deployDeployAction --deploy 5125ab12 /var/www/DEPLOY/coolApp/ /var/www/apps/coolApp/ "www-data@host0 www-data@host1 stageuser@host3" "www-data@host4"

#### Arguments

- `--target target` - Optional. String. Build target file base name, defaults to `app.tar.gz`
- `--deploy` - Default. Flag. deploy an application to a remote host
- `--revert` - Optional. Flag. Reverses a deployment
- `--cleanup` - Optional. Flag. After all hosts have been `--deploy`ed successfully the `--cleanup` step is run on all hosts to finish up (or clean up) the deployment.
- `--help` - Optional. Flag. Show help
- `--debug` - Optional. Flag. Turn on debugging (defaults to `BUILD_DEBUG` environment variable)
- `--versions - deployHome` - Required. Path. Remote path where we can store deployment state files.
- `--id applicationId` - Required. String. The application package will contain a `.env` with `APPLICATION_ID` set to this Value
- `--application applicationPath` - Required. Path. Path where the application will be deployed
- `userAtHost` - Required. Strings. A list of space-separated values or arguments which match users at remote hosts. Due to shell quoting peculiarities you can pass in space-delimited arguments as single arguments.

#### Exit codes

- `0` - Always succeeds

#### Local cache

`deployHome` is considered a state directory so removing entries in this should be managed separately.

### `directoryClobber` - Copy directory over another sort-of-atomically

Copy directory over another sort-of-atomically

#### Exit codes

- `0` - Always succeeds

### `dotEnvConfig` - Deprecated:

Deprecated:

#### Exit codes

- `0` - Always succeeds

#### See Also

- [function dotEnvConfigure
](./docs/tools/pipeline.md
) - [Load `.env` and optional `.env.local` into bash context
](https://github.com/zesk/build/blob/main/bin/build/tools/pipeline.sh#L41
)

### `dumpFile` - dumpFile fileName0 [ fileName1 ... ]

dumpFile fileName0 [ fileName1 ... ]

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

### `gitMainly` - Merge `staging` and `main` branches of a Git repository into

Merge `staging` and `main` branches of a Git repository into the current branch.

Will merge `origin/staging` and `origin/main` after doing a `--pull` for both of them

Current repository should be clean and have no modified files.

#### Usage

    gitMainly
    

#### Exit codes

- `1` - Already in main, staging, or HEAD, or git merge failed
- `0` - git merge succeeded

### `deploy-shutdown.sh` - Deployment "start" script

Deployment "start" script

#### Examples

- Move directories to make deployment final

#### Exit codes

- `0` - This SHOULD exit successfully always

### `maintenance.sh
 [ --message message ] maintenanceSetting` - Toggle maintenance on or off. The default version of this

Toggle maintenance on or off. The default version of this modifies
the environment files for the application by modifying the `.env.local` file
and dynamically adding or removing any line which matches the MAINTENANCE variable.

#### Arguments

- `message` - Required. String. Maintenance setting: `on | 1 | true | off 0 | false`
- `maintenanceSetting` - Required. String. Maintenance setting: `on | 1 | true | off 0 | false`

#### Exit codes

- `0` - Always succeeds

#### Environment

BUILD_MAINTENANCE_VARIABLE - If you want to use a different environment variable than `MAINTENANCE`, set this environment variable to the variable you want to use.

#### Exit codes

- `0` - Always succeeds

### `mapValueTrim` - Maps a string using an environment file

Maps a string using an environment file

#### Usage

    mapValue mapFile [ value ... ]
    

#### Arguments

- `mapFile` - a file containing bash environment definitions
- `value` - One or more values to map using said environment file

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

### `php-test.sh` - Test a docker-based PHP application during build

Test a docker-based PHP application during build

#### Arguments

- `deployment` - Required. String. `production` or `develop`

#### Exit codes

- `0` - Always succeeds

#### Examples

    save=$(saveErrorExit)
    set +x
    ... some nasty stuff
    restoreErrorExit "$save"

#### Exit codes

- `0` - Always succeeds

#### See Also

- [function saveErrorExit
](./docs/tools/todo.md
) - [{summary}](https://github.com/zesk/build/blob/main/bin/build/tools/debug.sh#L94
)

#### Examples

    save=$(saveErrorExit)
    set +x
    ... some nasty stuff
    restoreErrorExit "$save"

#### Exit codes

- `0` - Always succeeds

#### See Also

- [function restoreErrorExit
](./docs/tools/todo.md
) - [{summary}](https://github.com/zesk/build/blob/main/bin/build/tools/debug.sh#L106
)

#### Exit codes

- `0` - Always succeeds

### `serviceControlDaemon` - Runs a daemon which monitors files and operates on services.

Runs a daemon which monitors files and operates on services.

To request a specific action write the file with the action as the first line.

Allows control across user boundaries.

Specify actions more than once on the command line to specify more than one set of permissions.

#### Arguments

- `--home serviceHome` - Optional. Service directory home. Defaults to `/etc/service`.
- `--interval intervalSeconds` - Optional. Number of seconds to check for presence of the file. Defaults to 10.
- `--stat statFile` - Optional. Output the `svstat` status to this file every `intervalSeconds`. If not specified nothing is output.
- `--chirp chirpSeconds` - Optional. Output a message saying we're alive every `chirpSeconds` seconds.
- `--action actions` - Optional. String. Onr or more actions permitted `start`, `stop`, `restart`, use comma to separate. Default is `restart`.
- `service0` - Required. Directory. Service to control (e.g. `/etc/service/application/`)
- `file1` - Required. File. Absolute path to a file. Presence of  `file` triggers `action`

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

### `showContext` - Open a file in a shell using the program we

Open a file in a shell using the program we are using. Supports VSCode and PHPStorm.

#### Exit codes

- `0` - Always succeeds

#### Environment

EDITOR - Used as a default editor (first)
VISUAL - Used as another default editor (last)

#### Exit codes

- `0` - Always succeeds

### `simpleBashFunction` - A contrived function to show some features and patterns.

A contrived function to show some features and patterns.

#### Arguments

- `--debug` - Flag. Optional. Debugging mode.
- `--cleanup` - Flag. Optional. Debugging mode.
- `--undo` - Flag. Optional. Debugging mode.
- `--home homePath` - Required. Directory. Home path to show off directory validation.
- `--target target` - Required. File. Target file to show off file validation.
- `--id id` - Optional. String. Just an argument with a value.
- `--application applicationPath` - Required. Directory. Application path to show off directory validation.

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

#### Arguments

- `--skip-commit` - Skip the commit if the files change

#### Exit codes

- `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

#### Usage



#### Exit codes

- `0` - Always succeeds

### `webApplicationConfigure` - Configure the web application server as root

Configure the web application server as root

#### Usage

    
    #### Usage
    
    
    
    #### Exit codes
    
    - `0` - Always succeeds

#### Exit codes

- `0` - Always succeeds

### `wrapLines` - Prefix output lines with a string

Wrap lines with a string, useful to format output or add color codes to
consoles which do not honor colors line-by-line. Intended to be used as a pipe.

#### Usage

    wrapLines [ prefix [ suffix ... ] ] < fileToPrefixLines
    

#### Arguments

- `prefix` - Prefix each line with this text
- `suffix` - Prefix each line with this text

#### Examples

    cat "$file" | prefixLines "$(consoleCode)"
    cat "$errors" | prefixLines "    ERROR: "

#### Exit codes

- 0

[⬅ Return to index](index.md)
[⬅ Return to top](../index.md)

Copyright &copy; 2024 [Market Acumen, Inc.]('https://marketacumen.com?crcat=codeUnable to find "BUILD_COMPANY_LINK" (using index "/Users/kent/.build")crsource=zesk/buildUnable to find "BUILD_COMPANY_LINK" (using index "/Users/kent/.build")crcampaign=docsUnable to find "BUILD_COMPANY_LINK" (using index "/Users/kent/.build")crkw='Missing functions)
